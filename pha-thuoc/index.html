<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>T√≠nh l∆∞·ª£ng thu·ªëc s√°t tr√πng</title>

  <!-- üîé SEO & Sharing -->
  <meta name="description" content="C√¥ng c·ª• t√≠nh l∆∞·ª£ng thu·ªëc s√°t tr√πng theo t·ª∑ l·ªá pha v√† d·∫°ng thu·ªëc. C√≥ th·ªÉ c√†i ƒë·∫∑t nh∆∞ m·ªôt ·ª©ng d·ª•ng di ƒë·ªông, ho·∫°t ƒë·ªông offline v√† s·ª≠ d·ª•ng d·ªÖ d√†ng cho trang tr·∫°i.">
  <meta name="keywords" content="t√≠nh thu·ªëc s√°t tr√πng, pha thu·ªëc, thu·ªëc s√°t tr√πng tr·∫°i heo, pha thu·ªëc chƒÉn nu√¥i, thu·ªëc n∆∞·ªõc, thu·ªëc b·ªôt, ·ª©ng d·ª•ng offline, ATSH, an to√†n sinh h·ªçc">
  <meta name="author" content="Ho√†ng ƒê·ª£i">
  <meta name="robots" content="index, follow">
  <link rel="canonical" href="https://hoangdoinet.github.io/pha-thuoc/">

  <!-- Open Graph -->
  <meta property="og:title" content="T√≠nh l∆∞·ª£ng thu·ªëc s√°t tr√πng ‚Äì C√†i ƒë·∫∑t nh∆∞ ·ª©ng d·ª•ng di ƒë·ªông">
  <meta property="og:description" content="Nh·∫≠p s·ªë l√≠t n∆∞·ªõc v√† ch·ªçn t·ª∑ l·ªá ƒë·ªÉ t√≠nh ngay l∆∞·ª£ng thu·ªëc s√°t tr√πng c·∫ßn d√πng. H·ªó tr·ª£ thu·ªëc n∆∞·ªõc & thu·ªëc b·ªôt. Ho·∫°t ƒë·ªông offline, c√†i ƒë·∫∑t tr√™n Android/iOS.">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://hoangdoinet.github.io/pha-thuoc/">
  <meta property="og:image" content="https://hoangdoinet.github.io/pha-thuoc/icons/og-image-1200.png">
  <meta property="og:locale" content="vi_VN">
  <meta property="og:site_name" content="T√≠nh thu·ªëc s√°t tr√πng">

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="T√≠nh l∆∞·ª£ng thu·ªëc s√°t tr√πng ‚Äì C√¥ng c·ª• h·ªØu √≠ch cho trang tr·∫°i">
  <meta name="twitter:description" content="Pha thu·ªëc s√°t tr√πng ch√≠nh x√°c theo t·ª∑ l·ªá, ho·∫°t ƒë·ªông offline, c√†i ƒë·∫∑t nh∆∞ ·ª©ng d·ª•ng di ƒë·ªông.">
  <meta name="twitter:image" content="https://hoangdoinet.github.io/pha-thuoc/icons/og-image-1200.png">

  <!-- PWA -->
  <meta name="theme-color" content="#22c55e"/>
  <link rel="manifest" href="./manifest.webmanifest">
  <!-- D√πng icon 1024 m·ªõi l√†m favicon & apple-touch -->
  <link rel="icon" href="./icons/icon-1024.png" sizes="1024x1024">
  <link rel="apple-touch-icon" href="./icons/icon-1024.png">
  <!-- Th√™m icon 192 cho tr√¨nh duy·ªát c≈© (kh√¥ng b·∫Øt bu·ªôc) -->
  <link rel="icon" href="./icons/icon-192.png" sizes="192x192">

  <!-- iOS web app -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="Pha thu·ªëc">

  <style>
    :root{
      --bg:#0b1220; --card:#0f172a; --text:#e5e7eb; --muted:#94a3b8;
      --accent:#22c55e; --border:#1f2937; --info:#0ea5e9; --danger:#ef4444;
      /* m√†u splash nh∆∞ m·∫´u */
      :root{ --brand1:#22c55e; --brand2:#16a34a; }
    }
    *{box-sizing:border-box}
    body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif;
      background:linear-gradient(180deg,#0b1220,#0e1a33);color:var(--text);min-height:100vh}

    /* ===================== SPLASH (theo m·∫´u) ===================== */
    #splash{
      position:fixed; inset:0;
      padding: calc(env(safe-area-inset-top,0) + 16px) 16px calc(env(safe-area-inset-bottom,0) + 16px);
      background:
        radial-gradient(120% 90% at 50% -10%, #fff3 0%, #0000 60%),
        linear-gradient(180deg,var(--brand1),var(--brand2));
      color:#fff; display:flex; flex-direction:column; align-items:center; justify-content:center;
      z-index:9999; text-align:center; transition:opacity .7s ease, visibility .7s;
    }
    #splash.hidden{ opacity:0; visibility:hidden; }

    .logo-wrap{ position:relative; width:140px; height:140px; filter:drop-shadow(0 10px 24px rgba(0,0,0,.28)); }
    .logo-img{
      width:100%; height:100%; border-radius:24%;
      animation: popIn 900ms cubic-bezier(.2,.7,.2,1) both, glow 1.6s .9s ease-in-out 2 alternate;
      will-change: transform, filter;
    }
    .logo-wrap::after{
      content:""; position:absolute; inset:-8%;
      background: linear-gradient(75deg, transparent 30%, #fff6 48%, #fff9 52%, transparent 70%);
      transform: translateX(-120%) rotate(8deg);
      border-radius:28%;
      animation: sweep 1.1s .35s ease-out forwards;
      pointer-events:none; mix-blend-mode:overlay;
    }
    .app-name{
      margin-top:14px; font-size:24px; font-weight:800; letter-spacing:.8px;
      overflow:hidden; white-space:nowrap; border-right:2px solid rgba(255,255,255,.85);
      width:0; animation: typing 1.4s .45s steps(18,end) forwards, caret .9s step-end infinite;
      text-shadow: 0 1px 2px #0003;
    }
    .meta{ margin-top:8px; font-size:14px; opacity:.95 }
    .meta b{ font-weight:800 }

    /* ·∫®n app t·ªõi khi splash t·∫Øt */
    #app{ visibility:hidden; }
    body.ready #app{ visibility:visible; }

    /* Keyframes */
    @keyframes popIn{ 0%{ transform: scale(.6) rotate(-8deg); opacity:0 } 60%{ transform: scale(1.08) rotate(3deg); opacity:1 } 100%{ transform: scale(1) rotate(0) } }
    @keyframes glow{ from{ filter: drop-shadow(0 10px 24px rgba(0,0,0,.28)) brightness(1) saturate(1) } to{ filter: drop-shadow(0 12px 34px rgba(0,0,0,.35)) brightness(1.08) saturate(1.1) } }
    @keyframes sweep{ to{ transform: translateX(120%) rotate(8deg); opacity:0 } }
    @keyframes typing{ from{ width:0 } to{ width:100% } }
    @keyframes caret{ 50%{ border-color: transparent } }

    @media (prefers-reduced-motion: reduce){
      .logo-img, .logo-wrap::after, .app-name{ animation: none !important }
      #splash{ transition: opacity .2s ease, visibility .2s }
    }
    /* =================== /SPLASH =================== */

    .wrap{max-width:860px;margin:32px auto;padding:0 16px}
    header.hero{text-align:center;margin-bottom:16px}
    header.hero h1{font-size:28px;margin:0}
    .badge{display:inline-block;background:rgba(34,197,94,.15);padding:4px 10px;
      border-radius:20px;font-size:12px;color:#86efac;margin-top:6px}
    .card{background:rgba(255,255,255,.02);border:1px solid var(--border);
      border-radius:16px;box-shadow:0 12px 40px rgba(0,0,0,.35);padding:20px}
    .group{margin-bottom:16px}
    label{display:block;margin-bottom:6px;font-size:14px;color:var(--muted)}
    .segmented{display:flex;border:1px solid var(--border);border-radius:999px;overflow:hidden}
    .segmented input{display:none}
    .segmented label{flex:1;text-align:center;padding:10px;cursor:pointer;color:var(--muted)}
    .segmented input:checked + label{background:var(--accent);color:#052e14;font-weight:600}
    select,input{width:100%;padding:10px;border:1px solid var(--border);border-radius:12px;
      background:#0b1020;color:var(--text);font-size:16px}
    select:focus,input:focus{outline:none;border-color:var(--accent)}
    .chips{display:flex;flex-wrap:wrap;gap:8px;margin-top:8px}
    .chip{padding:6px 12px;border:1px solid var(--border);border-radius:20px;
      background:rgba(255,255,255,.03);cursor:pointer;font-size:13px;color:var(--muted)}
    .chip:hover{border-color:var(--accent);color:#a7f3d0}
    .alert{border-radius:14px;padding:12px;margin-top:12px;display:none}
    .alert-info{background:rgba(14,165,233,.12);border:1px solid rgba(14,165,233,.35);color:#bae6fd}
    .alert-danger{background:rgba(239,68,68,.1);border:1px solid rgba(239,68,68,.35);color:#fecaca}
    footer{text-align:center;opacity:.7;padding:18px 12px;font-size:13px}
  </style>
</head>
<body>
  <!-- üåæ Splash theo m·∫´u -->
  <div id="splash" role="status" aria-label="ƒêang kh·ªüi ƒë·ªông ·ª©ng d·ª•ng">
    <div class="logo-wrap">
      <img src="./icons/icon-1024.png" class="logo-img" alt="Logo T√≠nh l∆∞·ª£ng thu·ªëc s√°t tr√πng" width="140" height="140">
    </div>
    <div class="app-name" aria-hidden="true">PHA THU·ªêC S√ÅT TR√ôNG</div>
    <div class="meta">Phi√™n b·∫£n: <b>v1.0.0</b></div>
    <div class="meta">T√°c gi·∫£: <b>Ho√†ng ƒê·ª£i</b></div>
  </div>

  <!-- B·ªçc to√†n b·ªô app ƒë·ªÉ ·∫©n t·ªõi khi splash xong -->
  <div id="app">
    <!-- iOS h∆∞·ªõng d·∫´n -->
    <div class="ios-tip" id="iosTip" style="display:none;background:rgba(15,23,42,.95);padding:12px 14px;border-radius:14px;border:1px solid #1f2937;font-size:14px;backdrop-filter:blur(6px);position:fixed;left:12px;right:12px;bottom:12px;z-index:50">
      <button id="iosClose" style="float:right;background:#22c55e;border:none;color:#063016;border-radius:10px;padding:8px 12px;font-weight:600;cursor:pointer">ƒê√£ hi·ªÉu</button>
      <b style="color:#86efac">M·∫πo:</b> Tr√™n iPhone/iPad ‚Üí Safari ‚Üí <b>Chia s·∫ª</b> ‚Üí <b>Th√™m v√†o MH ch√≠nh</b> ƒë·ªÉ c√†i nh∆∞ ·ª©ng d·ª•ng.
    </div>

    <!-- Android c√†i ƒë·∫∑t -->
    <button class="install-btn" id="btnInstall" style="display:none;position:fixed;right:14px;bottom:14px;background:#22c55e;color:#063016;border:none;border-radius:14px;padding:12px 14px;font-weight:700;box-shadow:0 10px 24px rgba(0,0,0,.25)">üì• C√†i ƒë·∫∑t ·ª©ng d·ª•ng</button>

    <div class="wrap">
      <header class="hero">
        <h1>T√≠nh l∆∞·ª£ng thu·ªëc s√°t tr√πng</h1>
        <div class="badge">Phi√™n b·∫£n: v1.0.0</div>
      </header>

      <main class="card">
        <div class="group">
          <label>Lo·∫°i thu·ªëc</label>
          <div class="segmented">
            <input type="radio" name="medicineFormType" id="liquidMedicine" value="liquid" checked>
            <label for="liquidMedicine">Thu·ªëc n∆∞·ªõc</label>
            <input type="radio" name="medicineFormType" id="powderMedicine" value="powder">
            <label for="powderMedicine">Thu·ªëc b·ªôt</label>
          </div>
        </div>

        <div class="group">
          <label for="medicineType">T·ª∑ l·ªá pha</label>
          <select id="medicineType" required>
            <option value="">Ch·ªçn t·ª∑ l·ªá</option>
            <option value="1:100">1:100</option>
            <option value="1:200">1:200</option>
            <option value="1:300">1:300</option>
            <option value="1:400">1:400</option>
            <option value="1:500">1:500</option>
            <option value="1:600">1:600</option>
            <option value="1:700">1:700</option>
            <option value="1:800">1:800</option>
            <option value="1:900">1:900</option>
            <option value="1:1000">1:1000</option>
          </select>
          <div class="chips" id="ratioChips">
            <div class="chip" data-ratio="1:100">1:100</div>
            <div class="chip" data-ratio="1:200">1:200</div>
            <div class="chip" data-ratio="1:300">1:300</div>
            <div class="chip" data-ratio="1:400">1:400</div>
            <div class="chip" data-ratio="1:500">1:500</div>
            <div class="chip" data-ratio="1:600">1:600</div>
            <div class="chip" data-ratio="1:700">1:700</div>
            <div class="chip" data-ratio="1:800">1:800</div>
            <div class="chip" data-ratio="1:900">1:900</div>
            <div class="chip" data-ratio="1:1000">1:1000</div>
          </div>
        </div>

        <div class="group">
          <label for="litersOfWater">S·ªë l∆∞·ª£ng n∆∞·ªõc (l√≠t)</label>
          <input type="number" id="litersOfWater" step="0.1" min="0" placeholder="Nh·∫≠p s·ªë l√≠t n∆∞·ªõc c·∫ßn s·ª≠ d·ª•ng" required>
        </div>

        <div class="alert alert-info" id="result"></div>
        <div class="alert alert-danger" id="error">B·∫°n ch∆∞a <strong>ch·ªçn t·ª∑ l·ªá thu·ªëc</strong> ƒë·ªÉ hi·ªÉn th·ªã k·∫øt qu·∫£.</div>
      </main>

      <footer>¬© 2025 - Ho√†ng ƒê·ª£i</footer>
    </div>
  </div>

  <script>
    // ƒêƒÉng k√Ω Service Worker (offline-lockdown)
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', async () => {
        try {
          await navigator.serviceWorker.register('./service-worker.js', { scope: './', updateViaCache: 'none' });
        } catch (e) { console.warn('SW register failed', e); }
      });
    }

    // ·∫®n splash khi trang s·∫µn s√†ng ho·∫∑c sau timeout d·ª± ph√≤ng
    const hideSplash = () => {
      const el = document.getElementById('splash');
      if (!el || el.classList.contains('hidden')) return;
      el.classList.add('hidden');
      document.body.classList.add('ready');
    };
    // Khi t·∫£i xong + th√™m buffer ƒë·ªÉ animation k·∫øt th√∫c ‚Äúƒë√£‚Äù
    window.addEventListener('load', () => { setTimeout(hideSplash, 2800); });
    // D·ª± ph√≤ng c·ª©ng n·∫øu v√¨ l√Ω do n√†o ƒë√≥ load b·ªã ch·∫≠m
    setTimeout(hideSplash, 5000);

    // A2HS Android
    let deferredPrompt;
    const btnInstall = document.getElementById('btnInstall');
    window.addEventListener('beforeinstallprompt', (e) => {
      e.preventDefault(); deferredPrompt = e; btnInstall.style.display = 'inline-block';
    });
    btnInstall.addEventListener('click', async () => {
      if (!deferredPrompt) return;
      deferredPrompt.prompt(); await deferredPrompt.userChoice;
      btnInstall.style.display = 'none'; deferredPrompt = null;
    });

    // iOS tip
    function isIos(){return /iphone|ipad|ipod/i.test(navigator.userAgent)}
    function isStandalone(){return navigator.standalone || window.matchMedia('(display-mode: standalone)').matches}
    window.addEventListener('load',()=>{
      if(isIos()&&!isStandalone()) document.getElementById('iosTip').style.display='block';
      document.getElementById('iosClose').onclick=()=>document.getElementById('iosTip').remove();
    });

    // T√≠nh to√°n
    function calculate(){
      const liters=parseFloat(document.getElementById('litersOfWater').value);
      const type=document.getElementById('medicineType').value;
      const form=document.querySelector('input[name="medicineFormType"]:checked').value;
      const error=document.getElementById('error');
      const result=document.getElementById('result');
      error.style.display='none'; result.style.display='none';
      if(!liters) return;
      if(!type){ error.style.display='block'; return; }
      if(isNaN(liters)||liters<=0){ error.style.display='block'; error.innerHTML='B·∫°n ch∆∞a <strong>Nh·∫≠p l∆∞·ª£ng n∆∞·ªõc</strong> ƒë·ªÉ hi·ªÉn th·ªã k·∫øt qu·∫£.'; return; }
      const ratios={'1:100':100,'1:200':200,'1:300':300,'1:400':400,'1:500':500,'1:600':600,'1:700':700,'1:800':800,'1:900':900,'1:1000':1000};
      const volume=(1000/ratios[type])*liters;
      const display=form==='powder'?volume.toFixed(0)+' gram':(Number.isInteger(volume)?volume:volume.toFixed(2))+' ml';
      result.style.display='block';
      result.innerHTML=`V·ªõi t·ª∑ l·ªá <strong>${type}</strong>, c·∫ßn pha:<br><strong>${liters} l√≠t</strong> n∆∞·ªõc = <strong>${display}</strong> thu·ªëc`;
    }
    document.getElementById('litersOfWater').addEventListener('input',calculate);
    document.getElementById('medicineType').addEventListener('change',calculate);
    document.querySelectorAll('input[name="medicineFormType"]').forEach(r=>r.addEventListener('change',calculate));
    document.getElementById('ratioChips').addEventListener('click',e=>{
      const c=e.target.closest('.chip'); if(!c) return;
      document.getElementById('medicineType').value=c.getAttribute('data-ratio');
      calculate();
    });

    // Shortcut ratio t·ª´ URL
    const p=new URLSearchParams(location.search); const r=p.get('ratio');
    if(r){ document.getElementById('medicineType').value=r; calculate(); }
  </script>
</body>
</html>