<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>T√≠nh l∆∞·ª£ng thu·ªëc s√°t tr√πng</title>

  <!-- üîé SEO & Sharing -->
  <meta name="description" content="C√¥ng c·ª• t√≠nh l∆∞·ª£ng thu·ªëc s√°t tr√πng theo t·ª∑ l·ªá pha v√† d·∫°ng thu·ªëc. C√≥ th·ªÉ c√†i ƒë·∫∑t ·ª©ng d·ª•ng tr√™n Android & iOS, ho·∫°t ƒë·ªông offline v√† s·ª≠ d·ª•ng d·ªÖ d√†ng cho trang tr·∫°i.">
  <meta name="keywords" content="t√≠nh thu·ªëc s√°t tr√πng, pha thu·ªëc, thu·ªëc s√°t tr√πng tr·∫°i heo, pha thu·ªëc chƒÉn nu√¥i, thu·ªëc n∆∞·ªõc, thu·ªëc b·ªôt, ·ª©ng d·ª•ng offline, ATSH, an to√†n sinh h·ªçc">
  <meta name="author" content="Ho√†ng ƒê·ª£i">
  <meta name="robots" content="index, follow">
  <link rel="canonical" href="https://hoangdoinet.github.io/pha-thuoc/"/>

  <!-- Open Graph -->
  <meta property="og:title" content="T√≠nh l∆∞·ª£ng thu·ªëc s√°t tr√πng">
  <meta property="og:description" content="Nh·∫≠p s·ªë l√≠t n∆∞·ªõc v√† ch·ªçn t·ª∑ l·ªá ƒë·ªÉ t√≠nh ngay l∆∞·ª£ng thu·ªëc s√°t tr√πng c·∫ßn d√πng. H·ªó tr·ª£ thu·ªëc n∆∞·ªõc & thu·ªëc b·ªôt. Ho·∫°t ƒë·ªông offline sau khi c√†i ƒë·∫∑t tr√™n Android/iOS.">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://hoangdoinet.github.io/pha-thuoc/">
  <meta property="og:image" content="https://hoangdoinet.github.io/pha-thuoc/icons/og-image-1200.png">
  <meta property="og:locale" content="vi_VN">
  <meta property="og:site_name" content="T√≠nh thu·ªëc s√°t tr√πng">

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="T√≠nh l∆∞·ª£ng thu·ªëc s√°t tr√πng ‚Äì C√¥ng c·ª• h·ªØu √≠ch cho trang tr·∫°i">
  <meta name="twitter:description" content="Pha thu·ªëc s√°t tr√πng ch√≠nh x√°c theo t·ª∑ l·ªá, ho·∫°t ƒë·ªông offline, c√†i ƒë·∫∑t nh∆∞ ·ª©ng d·ª•ng di ƒë·ªông.">
  <meta name="twitter:image" content="https://hoangdoinet.github.io/pha-thuoc/icons/og-image-1200.png">

  <!-- iOS web app -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="Pha thu·ªëc">

  <!-- PWA -->
  <meta name="theme-color" content="#22c55e"/>
  <link rel="manifest" href="./manifest.webmanifest">
  <link rel="icon" href="./icons/icon-1024.png" sizes="1024x1024">
  <link rel="apple-touch-icon" href="./icons/icon-1024.png">
  <link rel="icon" href="./icons/icon-192.png" sizes="192x192">

  <style>
    :root{
      --bg:#0b1220; --card:#0f172a; --text:#e5e7eb; --muted:#94a3b8;
      --accent:#22c55e; --border:#94a3b8; --info:#0ea5e9; --danger:#ef4444;
      --brand1:#22c55e; --brand2:#16a34a;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif;
      background:linear-gradient(180deg,#0b1220,#0e1a33);
      color:var(--text);
      min-height:95vh;
    }

    /* ===================== SPLASH ===================== */
    #splash{
      position:fixed;inset:0;
      padding:calc(env(safe-area-inset-top,0) + 16px) 16px calc(env(safe-area-inset-bottom,0) + 16px);
      background:radial-gradient(120% 90% at 50% -10%, #fff3 0%, #0000 60%),linear-gradient(180deg,var(--brand1),var(--brand2));
      color:#fff;display:flex;flex-direction:column;align-items:center;justify-content:center;z-index:9999;text-align:center;transition:opacity .7s ease,visibility .7s
    }
    #splash.hidden{opacity:0;visibility:hidden}
    .logo-wrap{position:relative;width:140px;height:140px;filter:drop-shadow(0 10px 24px rgba(0,0,0,.28))}
    .logo-img{width:100%;height:100%;border-radius:24%;animation:popIn 900ms cubic-bezier(.2,.7,.2,1) both,glow 1.6s .9s ease-in-out 2 alternate;will-change:transform,filter}
    .logo-wrap::after{content:"";position:absolute;inset:-8%;background:linear-gradient(75deg,transparent 30%,#fff6 48%,#fff9 52%,transparent 70%);transform:translateX(-120%) rotate(8deg);border-radius:28%;animation:sweep 1.1s .35s ease-out forwards;pointer-events:none;mix-blend-mode:overlay}
    .app-name{margin-top:14px;font-size:24px;font-weight:800;letter-spacing:.8px;overflow:hidden;white-space:nowrap;border-right:2px solid rgba(255,255,255,.85);width:0;animation:typing 1.4s .45s steps(18,end) forwards,caret .9s step-end infinite;text-shadow:0 1px 2px #0003}
    .meta{margin-top:8px;font-size:14px;opacity:.95}
    .meta b{font-weight:800}
    #app{visibility:hidden}
    body.ready #app{visibility:visible}
    @keyframes popIn{0%{transform:scale(.6) rotate(-8deg);opacity:0}60%{transform:scale(1.08) rotate(3deg);opacity:1}100%{transform:scale(1) rotate(0)}}
    @keyframes glow{from{filter:drop-shadow(0 10px 24px rgba(0,0,0,.28)) brightness(1) saturate(1)}to{filter:drop-shadow(0 12px 34px rgba(0,0,0,.35)) brightness(1.08) saturate(1.1)}}
    @keyframes sweep{to{transform:translateX(120%) rotate(8deg);opacity:0}}
    @keyframes typing{from{width:0}to{width:100%}}
    @keyframes caret{50%{border-color:transparent}}
    @media (prefers-reduced-motion: reduce){.logo-img,.logo-wrap::after,.app-name{animation:none !important}#splash{transition:opacity .2s ease,visibility .2s}}
    /* =================== /SPLASH =================== */

    .wrap{max-width:860px;margin:32px auto;padding:0 16px}
    header.hero{text-align:center;margin-bottom:16px}
    header.hero h1{font-size:28px;margin:0}
    .badge{
      display:inline-block;background:rgba(34,197,94,.15);
      padding:4px 10px;border-radius:20px;font-size:12px;color:#86efac;margin-top:6px;
      cursor:pointer; user-select:none; outline:none; border:1px dashed rgba(134,239,172,.25);
    }
    .badge:focus{box-shadow:0 0 0 3px rgba(34,197,94,.35)}
    .card{background:rgba(255,255,255,.02);border:1px solid var(--border);border-radius:16px;box-shadow:0 12px 40px rgba(0,0,0,.35);padding:20px}
    .group{margin-bottom:16px}
    label{display:block;margin-bottom:6px;font-size:14px;color:var(--muted)}

    /* Segmented control */
    .segmented{display:flex;border:1px solid var(--border);border-radius:999px;overflow:hidden}
    .segmented input{display:none}
    .segmented label{flex:1;text-align:center;padding:10px 14px;cursor:pointer;color:var(--muted);position:relative;user-select:none;transition:all .2s ease}
    .segmented input:checked + label{background:var(--accent);color:#052e14;font-weight:700;margin-bottom:-1px;padding-bottom:calc(10px + 1px)}

    select,input{width:100%;padding:10px;border:1px solid var(--border);border-radius:12px;background:#0b1020;color:var(--text);font-size:16px}
    select:focus,input:focus{outline:none;border-color:var(--accent)}

    .chips{display:flex;flex-wrap:wrap;gap:8px;margin-top:8px}
    .chip{
      padding:6px 16px;border:1px solid var(--border);border-radius:20px;
      background:rgba(255,255,255,.03);cursor:pointer;font-size:13px;color:#fff;
      transition:background .2s ease, color .2s ease, border-color .2s ease, transform .06s ease;
    }
    .chip:hover{ border-color:var(--accent); color:#86efac; background:rgba(34,197,94,.12) }
    .chip.is-active, .chip[aria-pressed="true"]{
      border-color:var(--accent); color:#86efac; background:rgba(34,197,94,.12);
    }

    .alert{border-radius:14px;padding:12px;margin-top:12px;display:none}
    .alert-info{background:rgba(14,165,233,.12);border:1px solid rgba(14,165,233,.35);color:#bae6fd}
    .alert-danger{background:rgba(239,68,68,.1);border:1px solid rgba(239,68,68,.35);color:#fecaca}
    footer{text-align:center;opacity:.7;padding:18px 12px;font-size:13px}

    /* ============ Modal (N·ªÄN S√ÅNG) ============ */
    .modal-backdrop{
      position:fixed; inset:0; background:rgba(0,0,0,.45);
      display:none; align-items:center; justify-content:center; z-index:10000;
      padding:16px;
    }
    .modal-backdrop.show{display:flex;}
    .modal{
      width:min(560px, 100%); max-height:90vh; overflow:auto;
      background:#ffffff; color:#0f172a; border:1px solid #e5e7eb; border-radius:16px;
      box-shadow:0 20px 60px rgba(0,0,0,.35);
    }
    .modal header{
      display:flex; align-items:center; justify-content:space-between;
      padding:14px 16px; border-bottom:1px solid #e5e7eb; background:#f8fafc;
    }
    .modal header h3{margin:0; font-size:18px; font-weight:800; color:#0f172a}
    .modal header .close{
      border:0; background:#f1f5f9; color:#0f172a; border-radius:10px; padding:6px 10px; cursor:pointer; font-weight:700;
    }
    .modal .content{padding:14px 16px; font-size:14px; line-height:1.5}
    .modal .content p{margin:0 0 8px}
    .modal .kv{display:grid; grid-template-columns:120px 1fr; gap:8px 12px; margin-top:8px}
    .modal .kv .key{color:#475569}
    .modal footer{
      display:flex; justify-content:flex-end; gap:8px; padding:14px 16px; border-top:1px solid #e5e7eb; background:#f8fafc;
    }
    .modal .btn{
      background:#22c55e; color:#063016; border:0; border-radius:10px; padding:10px 12px; font-weight:800; cursor:pointer;
    }
    .modal .btn.secondary{ background:#e2e8f0; color:#0f172a; }

    /* ============ Install button (floating) ============ */
    .install-btn{
      position:fixed; right:14px; bottom:14px;
      background:#22c55e; color:#063016; border:none; border-radius:14px;
      padding:12px 14px; font-weight:700; box-shadow:0 10px 24px rgba(0,0,0,.25); display:none;
    }
  </style>
</head>
<body>
  <!-- üåæ Splash -->
  <div id="splash" role="status" aria-label="ƒêang kh·ªüi ƒë·ªông ·ª©ng d·ª•ng">
    <div class="logo-wrap"><img src="./icons/icon-512.png" class="logo-img" alt="Logo T√≠nh l∆∞·ª£ng thu·ªëc s√°t tr√πng" width="140" height="140"></div>
    <div class="app-name" aria-hidden="true">PHA THU·ªêC S√ÅT TR√ôNG</div>
    <div class="meta">Phi√™n b·∫£n: <b>v1.0.2</b></div>
    <div class="meta">T√°c gi·∫£: <b>Ho√†ng ƒê·ª£i</b></div>
  </div>

  <div id="app">
    <!-- iOS h∆∞·ªõng d·∫´n -->
    <div class="ios-tip" id="iosTip" style="display:none;background:rgba(15,23,42,.95);padding:12px 14px;border-radius:14px;border:1px solid #1f2937;font-size:14px;backdrop-filter:blur(6px);position:fixed;left:12px;right:12px;bottom:12px;z-index:50">
      <button id="iosClose" style="float:right;background:#22c55e;border:none;color:#063016;border-radius:10px;padding:8px 12px;font-weight:600;cursor:pointer">ƒê√£ hi·ªÉu</button>
      <b style="color:#86efac">M·∫πo:</b> Tr√™n iPhone/iPad ‚Üí Safari ‚Üí <b>Chia s·∫ª</b> ‚Üí <b>Th√™m v√†o MH ch√≠nh</b> ƒë·ªÉ c√†i nh∆∞ ·ª©ng d·ª•ng.
    </div>

    <!-- Android c√†i ƒë·∫∑t (gi·ªØ N√öT N·ªîI) -->
    <button class="install-btn" id="btnInstall">üì• C√†i ƒë·∫∑t ·ª©ng d·ª•ng</button>

    <div class="wrap">
      <header class="hero">
        <h1>T√≠nh l∆∞·ª£ng thu·ªëc s√°t tr√πng</h1>
        <!-- Chip phi√™n b·∫£n (click ƒë·ªÉ m·ªü modal) -->
        <div id="appBadge" class="badge" role="button" tabindex="0" aria-label="Xem th√¥ng tin ·ª©ng d·ª•ng">Phi√™n b·∫£n: v1.0.2</div>
      </header>

      <main class="card">
        <div class="group">
          <label>Lo·∫°i thu·ªëc</label>
          <div class="segmented">
            <input type="radio" name="medicineFormType" id="liquidMedicine" value="liquid" checked>
            <label for="liquidMedicine">Thu·ªëc n∆∞·ªõc</label>
            <input type="radio" name="medicineFormType" id="powderMedicine" value="powder">
            <label for="powderMedicine">Thu·ªëc b·ªôt</label>
          </div>
        </div>

        <div class="group">
          <label for="medicineType">T·ª∑ l·ªá pha</label>
          <select id="medicineType" required>
            <option value="">Ch·ªçn t·ª∑ l·ªá</option>
            <option value="1:100">1:100</option>
            <option value="1:200">1:200</option>
            <option value="1:300">1:300</option>
            <option value="1:400">1:400</option>
            <option value="1:500">1:500</option>
            <option value="1:600">1:600</option>
            <option value="1:700">1:700</option>
            <option value="1:800">1:800</option>
            <option value="1:900">1:900</option>
            <option value="1:1000">1:1000</option>
          </select>
          <div class="chips" id="ratioChips">
            <div class="chip" data-ratio="1:100">1:100</div>
            <div class="chip" data-ratio="1:200">1:200</div>
            <div class="chip" data-ratio="1:300">1:300</div>
            <div class="chip" data-ratio="1:400">1:400</div>
            <div class="chip" data-ratio="1:500">1:500</div>
            <div class="chip" data-ratio="1:600">1:600</div>
            <div class="chip" data-ratio="1:700">1:700</div>
            <div class="chip" data-ratio="1:800">1:800</div>
            <div class="chip" data-ratio="1:900">1:900</div>
            <div class="chip" data-ratio="1:1000">1:1000</div>
          </div>
        </div>

        <div class="group">
          <label for="litersOfWater">S·ªë l∆∞·ª£ng n∆∞·ªõc (l√≠t)</label>
          <input type="number" id="litersOfWater" step="0.1" min="0" inputmode="decimal" placeholder="Nh·∫≠p s·ªë l√≠t n∆∞·ªõc c·∫ßn s·ª≠ d·ª•ng" required>
        </div>

        <div class="alert alert-info" id="result" aria-live="polite"></div>
        <div class="alert alert-danger" id="error">B·∫°n ch∆∞a <strong>ch·ªçn t·ª∑ l·ªá thu·ªëc</strong> ƒë·ªÉ hi·ªÉn th·ªã k·∫øt qu·∫£.</div>
      </main>

      <footer>¬© 2025 - Ho√†ng ƒê·ª£i</footer>
    </div>
  </div>

  <!-- ======= Modal Th√¥ng tin ·ª®ng d·ª•ng (N·ªÄN S√ÅNG) ======= -->
  <div id="aboutModal" class="modal-backdrop" aria-hidden="true">
    <div class="modal" role="dialog" aria-modal="true" aria-labelledby="aboutTitle" aria-describedby="aboutDesc">
      <header>
        <h3 id="aboutTitle">Th√¥ng tin ·ª©ng d·ª•ng</h3>
        <button id="aboutClose" class="close" aria-label="ƒê√≥ng">‚úï</button>
      </header>
      <div class="content">
        <p id="aboutDesc">C√¥ng c·ª• t√≠nh nhanh l∆∞·ª£ng thu·ªëc s√°t tr√πng theo t·ª∑ l·ªá pha v√† d·∫°ng thu·ªëc (n∆∞·ªõc/b·ªôt). H·ªó tr·ª£ c√†i ƒë·∫∑t ƒë·ªÉ d√πng offline tr√™n Android v√† iOS.</p>
        <div class="kv">
          <div class="key"><li>Phi√™n b·∫£n:</li></div><div><b>v1.0.2</b></div>
          <div class="key"><li>T√°c gi·∫£:</li></div><div><b>Ho√†ng ƒê·ª£i</b></div>
        </div>
      </div>
      <footer>
        <button class="btn secondary" id="aboutOk">ƒê√≥ng</button>
        <!-- N√∫t c√†i ƒë·∫∑t trong modal (·∫©n m·∫∑c ƒë·ªãnh, hi·ªán khi ƒë·ªß ƒëi·ªÅu ki·ªán) -->
        <button class="btn" id="modalInstall" style="display:none">üì• C√†i ƒë·∫∑t ·ª©ng d·ª•ng</button>
      </footer>
    </div>
  </div>

  <script>
    // ƒêƒÉng k√Ω Service Worker
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', async () => {
        try { await navigator.serviceWorker.register('./service-worker.js', { scope: './', updateViaCache: 'none' }); }
        catch (e) { console.warn('SW register failed', e); }
      });
    }

    // Splash control
    const hideSplash = () => { const el = document.getElementById('splash'); if(!el||el.classList.contains('hidden')) return; el.classList.add('hidden'); document.body.classList.add('ready'); };
    window.addEventListener('load', () => { setTimeout(hideSplash, 2200); });
    setTimeout(hideSplash, 3000);

    // iOS tip
    function isIos(){return /iphone|ipad|ipod/i.test(navigator.userAgent)}
    function isStandalone(){return navigator.standalone || window.matchMedia('(display-mode: standalone)').matches}
    window.addEventListener('load',()=>{ if(isIos()&&!isStandalone()) document.getElementById('iosTip').style.display='block'; document.getElementById('iosClose').onclick=()=>document.getElementById('iosTip').remove(); });

    // T√≠nh to√°n
    function calculate(){
      const liters=parseFloat(document.getElementById('litersOfWater').value);
      const type=document.getElementById('medicineType').value;
      const form=document.querySelector('input[name="medicineFormType"]:checked').value;
      const error=document.getElementById('error');
      const result=document.getElementById('result');
      error.style.display='none'; result.style.display='none';
      if(!liters) return;
      if(!type){ error.style.display='block'; error.innerHTML='B·∫°n ch∆∞a <strong>Ch·ªçn t·ª∑ l·ªá thu·ªëc</strong> ƒë·ªÉ hi·ªÉn th·ªã k·∫øt qu·∫£.'; return; }
      if(isNaN(liters)||liters<=0){ error.style.display='block'; error.innerHTML='B·∫°n ch∆∞a <strong>Nh·∫≠p l∆∞·ª£ng n∆∞·ªõc</strong> ƒë·ªÉ hi·ªÉn th·ªã k·∫øt qu·∫£.'; return; }
      const ratios={'1:100':100,'1:200':200,'1:300':300,'1:400':400,'1:500':500,'1:600':600,'1:700':700,'1:800':800,'1:900':900,'1:1000':1000};
      const volume=(1000/ratios[type])*liters;
      const display=(form==='powder') ? (Math.round(volume)+' gram') : ((Number.isInteger(volume)?volume:volume.toFixed(2))+' ml');
      result.style.display='block';
      result.innerHTML=`V·ªõi t·ª∑ l·ªá <strong>${type}</strong>, c·∫ßn pha:<br><strong>${liters} l√≠t</strong> n∆∞·ªõc = <strong>${display}</strong> thu·ªëc`;
    }
    document.getElementById('litersOfWater').addEventListener('input',calculate);
    document.getElementById('medicineType').addEventListener('change',calculate);
    document.querySelectorAll('input[name="medicineFormType"]').forEach(r=>{ r.addEventListener('change',calculate); });

    // Chips ch·ªçn nhanh
    const selectRatio = document.getElementById('medicineType');
    const chipWrap = document.getElementById('ratioChips');
    const chips = [...chipWrap.querySelectorAll('.chip')];

    function setActiveChip(ratio){
      chips.forEach(ch=>{
        const active = ch.dataset.ratio === ratio;
        ch.classList.toggle('is-active', active);
        ch.setAttribute('aria-pressed', active ? 'true' : 'false');
      });
    }
    chipWrap.addEventListener('click', e=>{
      const c = e.target.closest('.chip'); if(!c) return;
      const ratio = c.getAttribute('data-ratio');
      selectRatio.value = ratio;
      setActiveChip(ratio);
      calculate();
    });
    selectRatio.addEventListener('change', ()=> setActiveChip(selectRatio.value));
    chips.forEach(ch=>{
      ch.setAttribute('role','button');
      ch.setAttribute('tabindex','0');
      ch.setAttribute('aria-pressed','false');
      ch.addEventListener('keydown', e=>{
        if(e.key===' '||e.key==='Enter'){ e.preventDefault(); ch.click(); }
      });
    });

    // ========== Modal logic ==========
    const badge = document.getElementById('appBadge');
    const modalBackdrop = document.getElementById('aboutModal');
    const btnClose = document.getElementById('aboutClose');
    const btnOk = document.getElementById('aboutOk');

    function openModal(){
      modalBackdrop.classList.add('show');
      modalBackdrop.setAttribute('aria-hidden','false');
      setTimeout(()=>btnClose.focus(),0);
      document.documentElement.style.overflow='hidden';
    }
    function closeModal(){
      modalBackdrop.classList.remove('show');
      modalBackdrop.setAttribute('aria-hidden','true');
      document.documentElement.style.overflow='';
      badge && badge.focus();
    }
    if(badge){
      badge.addEventListener('click', openModal);
      badge.addEventListener('keydown', e=>{
        if(e.key==='Enter'||e.key===' '){ e.preventDefault(); openModal(); }
      });
    }
    btnClose.addEventListener('click', closeModal);
    btnOk.addEventListener('click', closeModal);
    modalBackdrop.addEventListener('click', e=>{
      if(e.target===modalBackdrop) closeModal();
    });
    window.addEventListener('keydown', e=>{
      if(e.key==='Escape' && modalBackdrop.classList.contains('show')) closeModal();
    });

    // ========== A2HS: ƒë·ªìng b·ªô n√∫t n·ªïi + n√∫t trong modal ==========
    let deferredPrompt;
    const btnInstall = document.getElementById('btnInstall');
    const modalInstall = document.getElementById('modalInstall');

    function updateInstallVisibility(){
      const canShow = !!deferredPrompt && !isStandalone();
      if (btnInstall)   btnInstall.style.display   = canShow ? 'inline-block' : 'none';
      if (modalInstall) modalInstall.style.display = canShow ? 'inline-block' : 'none';
    }

    window.addEventListener('beforeinstallprompt', (e) => {
      e.preventDefault();
      deferredPrompt = e;
      updateInstallVisibility();
    });

    async function triggerInstall(){
      if(!deferredPrompt){
        // iOS: hi·ªán tip n·∫øu ch∆∞a standalone
        if(isIos() && !isStandalone()){
          const tip = document.getElementById('iosTip');
          if(tip) tip.style.display='block';
        }
        return;
      }
      deferredPrompt.prompt();
      const { outcome } = await deferredPrompt.userChoice;
      deferredPrompt = null;
      updateInstallVisibility();
      if(outcome === 'accepted' && modalBackdrop.classList.contains('show')) closeModal();
    }
    window.addEventListener('appinstalled', () => {
      deferredPrompt = null;
      updateInstallVisibility();
    });
    if(btnInstall)   btnInstall.addEventListener('click', triggerInstall);
    if(modalInstall) modalInstall.addEventListener('click', triggerInstall);

    // Kh·ªüi t·∫°o chip t·ª´ URL n·∫øu c√≥
    const p=new URLSearchParams(location.search);
    const r=p.get('ratio');
    if(r){ selectRatio.value=r; }
    setActiveChip(selectRatio.value || r || '');
    if(selectRatio.value) calculate();

    // ·∫®n n√∫t c√†i ƒë·∫∑t n·∫øu ƒë√£ ch·∫°y ·ªü standalone
    updateInstallVisibility();
  </script>
</body>
</html>